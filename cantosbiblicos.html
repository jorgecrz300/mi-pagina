<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cancionero de Mam√° - Versi√≥n Corregida</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --naranja: #d35400; --verde: #27ae60; --crema: #fdfaf6; }
        body { font-family: 'Georgia', serif; background: var(--crema); margin: 0; padding: 15px; color: #333; }
        
        .header { text-align: center; border-bottom: 2px solid var(--naranja); margin-bottom: 20px; padding-bottom: 10px; }
        #buscador { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; margin-bottom: 20px; box-sizing: border-box; }

        .lista-cantos { display: flex; flex-direction: column; gap: 12px; }
        
        .fila-canto { 
            background: white; padding: 15px; border-radius: 10px; 
            display: flex; justify-content: space-between; align-items: center;
            border-left: 5px solid var(--naranja); box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .titulo-lista { font-size: 15px; font-weight: bold; color: #2c3e50; text-transform: uppercase; flex: 1; }
        
        .btn-descargar { 
            background: var(--verde); color: white; border: none; 
            padding: 10px 15px; border-radius: 8px; font-size: 13px; 
            font-weight: bold; cursor: pointer; margin-left: 10px;
        }

        /* √Årea de impresi√≥n ajustada para evitar cortes */
        #molde-pdf { display: none; }
        .hoja-pdf { 
            padding: 40px; 
            text-align: center; 
            background: white; 
            width: 750px; /* Ancho fijo para el motor de PDF */
            margin: 0 auto;
        }
    </style>
</head>
<body>

<div class="header">
    <h1 style="color: var(--naranja);">üìñ CANCIONERO DE MAM√Å</h1>
    <input type="search" id="buscador" placeholder="üîé Buscar por nombre de canto..." oninput="filtrar()">
</div>

<div class="lista-cantos" id="contenedor"></div>
<div id="molde-pdf"></div>

<script>
    // Lista completa y revisada (asegurando que ninguna est√© en blanco)
    const misCantos = [
        { t: "TE ALABO OH PADRE", l: "Te alabo oh Padre por tu gran amor,\nporque eres eterno, porque eres el Se√±or.\n\nTu amor es eterno, tu amor es verdad,\ngracias te damos por tu bondad.\n\nGracias por la vida, gracias por el sol,\ngracias te damos por tu amor Se√±or." },
        { t: "VASO NUEVO", l: "Gracias quiero darte por amarme,\ngracias quiero darte yo a ti Se√±or.\nHoy soy feliz porque te conoc√≠,\ngracias por amarme a mi tambi√©n.\n\nYo quiero ser, Se√±or amado,\ncomo el barro en manos del alfarero.\nToma mi vida y hazla de nuevo,\nyo quiero ser un vaso nuevo." },
        { t: "PESCADOR DE HOMBRES", l: "T√∫ has venido a la orilla,\nno has buscado ni a sabios ni a ricos,\ntan solo quieres que yo te siga.\n\nSe√±or, me has mirado a los ojos,\nsonriendo has dicho mi nombre,\nen la arena he dejado mi barca,\njunto a ti buscar√© otro mar.\n\nT√∫ necesitas mis manos,\nmi cansancio que a otros descanse,\namor que quiera seguir amando." },
        { t: "UNA MIRADA DE FE", l: "Una mirada de fe, una mirada de fe\nes la que puede salvar al pecador.\n\nY si t√∫ miras a Cristo Jes√∫s\n√âl te perdonar√°,\nporque una mirada de fe\nes la que puede salvar al pecador." },
        { t: "ESTO QUE TE DOY", l: "Esto que te doy es vino y pan Se√±or,\nesto que te doy es mi trabajo.\nEs mi coraz√≥n, mi alma,\nes mi cuerpo y mi raz√≥n,\nel esfuerzo de mi caminar.\n\nToma mi vida, ponla en tu coraz√≥n,\ndame tu mano y ll√©vame,\npastor de amor, Se√±or." },
        { t: "RENU√âVAME", l: "Renu√©vame Se√±or Jes√∫s,\nya no quiero ser igual.\nRenu√©vame Se√±or Jes√∫s,\npon en m√≠ tu coraz√≥n.\n\nPorque todo lo que hay dentro de m√≠,\nnecesita ser cambiado Se√±or.\nPorque todo lo que hay dentro de mi coraz√≥n,\nnecesita m√°s de ti." },
        { t: "CANTEMOS AL AMOR", l: "Cantemos al Amor de los amores,\ncantemos al Se√±or.\n¬°Dios est√° aqu√≠! Venid adoradores,\nadoremos a Cristo Redentor.\n\nGloria a Cristo Jes√∫s,\ncielos y tierra bendecid al Se√±or.\nHonor y gloria a ti, Rey de la gloria,\namor por siempre a ti, Dios del amor." },
        { t: "ALT√çSIMO SE√ëOR", l: "Alt√≠simo Se√±or, que supiste juntar\na un tiempo en el altar ser Cordero y Pastor.\n\nQuisiera con fervor recibirte en mi pecho,\ny ser de tu amor el m√°s dulce provecho." },
        { t: "ID Y ENSE√ëAD", l: "Sois la semilla que ha de crecer,\nsois estrella que ha de brillar.\nSois levadura, sois grano de sal,\nantorcha que debe alumbrar.\n\nId amigos por el mundo anunciando el amor,\nmensajeros de la vida, de la paz y el perd√≥n." },
        { t: "CAMINAR√â", l: "Caminar√© en presencia del Se√±or.\n\nAmo al Se√±or porque escucha mi voz suplicante,\nporque inclina su o√≠do hacia m√≠\nel d√≠a que lo invoco.\n\nMe envolv√≠an redes de muerte,\nca√≠ en tristeza y en angustia,\ninvoqu√© el nombre del Se√±or:\nSe√±or, salva mi vida." },
        { t: "SANTO (MISA)", l: "Santo, Santo, Santo es el Se√±or,\nDios del universo.\nLlenos est√°n el cielo y la tierra de tu gloria.\n\n¬°Hosanna en el cielo!\nBendito el que viene en nombre del Se√±or.\n¬°Hosanna en el cielo!" },
        { t: "CORDERO DE DIOS", l: "Cordero de Dios que quitas el pecado del mundo,\nten piedad de nosotros.\n\nCordero de Dios que quitas el pecado del mundo,\nten piedad de nosotros.\n\nCordero de Dios que quitas el pecado del mundo,\ndanos la paz." },
        { t: "GRACIAS SE√ëOR", l: "Gracias Se√±or, porque eres como eres,\ngracias porque me quieres\naunque soy pecador.\n\nGracias por este nuevo d√≠a,\ngracias por tu compa√±√≠a\ny por tu gran amor." },
        { t: "HOMBRES DE VALOR", l: "¬øQui√©n ir√° abriendo caminos?\n¬øQui√©n ir√° sembrando la paz?\n\nHombres de valor es lo que Dios busca,\nhombres que se entreguen por amor." },
        { t: "ACU√âRDATE", l: "Acu√©rdate, oh Virgen Mar√≠a,\nque jam√°s se ha o√≠do decir,\nque ninguno de los que han acudido a ti,\nhaya sido abandonado." },
        { t: "YO SOY EL PAN DE VIDA", l: "Yo soy el Pan de Vida,\nel que viene a m√≠ no tendr√° hambre,\nel que cree en m√≠ no tendr√° sed.\n\nNadie puede venir a m√≠,\nsi mi Padre no lo llama.\n\nY yo lo resucitar√©,\ny yo lo resucitar√©,\ny yo lo resucitar√© en el d√≠a final." },
        { t: "HOY PERD√ìNAME", l: "Hoy perd√≥name, hoy por siempre,\nsin mirar la mentira, lo vac√≠o de mi dar.\nSin mirar a donde voy ni mi paso al caminar.\n\nSi camin√© a la derecha,\no si me fui a la izquierda,\nhoy te pido perd√≥n Se√±or." }
    ];

    function cargarLista() {
        const div = document.getElementById('contenedor');
        div.innerHTML = '';
        const lista = [...misCantos].sort((a, b) => a.t.localeCompare(b.t));
        lista.forEach((c, i) => {
            div.innerHTML += `
                <div class="fila-canto">
                    <span class="titulo-lista">${c.t}</span>
                    <button class="btn-descargar" onclick="bajarHoja(${i})">PDF üì•</button>
                </div>
            `;
        });
    }

    function filtrar() {
        const texto = document.getElementById('buscador').value.toLowerCase();
        const filas = document.querySelectorAll('.fila-canto');
        const lista = [...misCantos].sort((a, b) => a.t.localeCompare(b.t));
        lista.forEach((c, i) => {
            filas[i].style.display = c.t.toLowerCase().includes(texto) ? 'flex' : 'none';
        });
    }

    function bajarHoja(index) {
        const lista = [...misCantos].sort((a, b) => a.t.localeCompare(b.t));
        const canto = lista[index];
        const molde = document.getElementById('molde-pdf');
        
        // Ajuste de tama√±o de fuente din√°mico para evitar cortes
        let fontSize = "24pt";
        if (canto.l.length > 400) fontSize = "20pt";
        if (canto.l.length > 600) fontSize = "17pt";

        molde.style.display = 'block';
        molde.innerHTML = `
            <div class="hoja-pdf">
                <h1 style="color: #d35400; font-size: 30pt; border-bottom: 2px solid #ddd; margin-bottom: 30px; text-transform: uppercase;">${canto.t}</h1>
                <p style="font-size: ${fontSize}; line-height: 1.6; white-space: pre-line; color: #000;">${canto.l}</p>
            </div>
        `;

        const opciones = {
            margin: [0.5, 0.5, 0.5, 0.5], // Margen de media pulgada por lado
            filename: `${canto.t}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2, letterRendering: true },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        };

        html2pdf().set(opciones).from(molde).save().then(() => {
            molde.style.display = 'none';
        });
    }

    cargarLista();
</script>
</body>
</html>
