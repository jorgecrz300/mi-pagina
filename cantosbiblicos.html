<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cancionero de Mam치 - Versi칩n Final</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --main-color: #d35400; --bg-paper: #fdfaf6; --text-color: #2c3e50; }
        
        body { font-family: 'Georgia', serif; background: var(--bg-paper); color: var(--text-color); margin: 0; padding: 15px; }
        
        .container { max-width: 100%; margin: auto; padding-bottom: 100px; }

        .header { text-align: center; margin-bottom: 25px; }
        h1 { font-size: 26px; color: var(--main-color); margin-bottom: 5px; }
        .sub { font-size: 13px; color: #7f8c8d; margin-bottom: 15px; }

        /* Buscador m칩vil */
        .search-container { display: flex; gap: 8px; margin-bottom: 20px; }

        #buscador { 
            flex: 1; padding: 15px; border-radius: 12px; 
            border: 2px solid var(--main-color); font-size: 16px;
            outline: none; background: white;
        }

        .btn-buscar {
            background: var(--main-color); color: white; border: none;
            padding: 0 20px; border-radius: 12px; font-size: 20px;
        }

        /* Tarjetas centradas */
        .canto-card { 
            background: white; padding: 30px 20px; border-radius: 15px; 
            box-shadow: 0 3px 10px rgba(0,0,0,0.05); text-align: center;
            border: 1px solid #f0e0d0; margin-bottom: 30px;
        }

        .titulo-canto { color: var(--main-color); font-size: 24px; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #fce4d6; display: inline-block; padding-bottom: 5px; }
        .letra-canto { font-size: 19px; white-space: pre-line; color: #34495e; line-height: 1.7; }

        /* Bot칩n de descarga */
        .btn-pdf { 
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: #27ae60; color: white; border: none; 
            padding: 18px; border-radius: 35px; font-weight: bold; 
            font-size: 16px; width: 85%; box-shadow: 0 5px 20px rgba(0,0,0,0.3); z-index: 100;
        }

        #area-pdf { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>游닀 Mi Cancionero</h1>
        <p class="sub">Toca la lupa para buscar letras nuevas en Google</p>
        <div class="search-container">
            <input type="search" id="buscador" placeholder="Buscar canto guardado..." oninput="filtrarLocal()">
            <button class="btn-buscar" onclick="buscarExterno()">游댌</button>
        </div>
    </div>
    
    <div id="visor">
        </div>

    <button class="btn-pdf" onclick="generarPDF()">游닌 GUARDAR LIBRO (PDF)</button>
</div>

<div id="area-pdf"></div>

<script>
    // LISTA DE CANTOS: Aqu칤 es donde agregas los que ella ya tiene
    const cantos = [
        { 
            titulo: "Pescador de Hombres", 
            letra: `T칰 has venido a la orilla,
                    no has buscado ni a sabios ni a ricos,
                    tan solo quieres que yo te siga.

                    Se침or, me has mirado a los ojos,
                    sonriendo has dicho mi nombre,
                    en la arena he dejado mi barca,
                    junto a ti buscar칠 otro mar.` 
        },
        { 
            titulo: "Hacia T칤", 
            letra: `Caminamos hacia t칤 se침or,
                    con esperanza y mucha fe,
                    gu칤anos por el buen camino,
                    que siempre te seguir칠.` 
        }
    ];

    function cargarCantos() {
        const visor = document.getElementById('visor');
        visor.innerHTML = '';
        cantos.forEach((canto) => {
            visor.innerHTML += `
                <div class="canto-card">
                    <div class="titulo-canto">${canto.titulo}</div>
                    <div class="letra-canto">${canto.letra}</div>
                </div>
            `;
        });
    }

    // Filtrar mientras escribe
    function filtrarLocal() {
        const query = document.getElementById('buscador').value.toLowerCase();
        const cards = document.querySelectorAll('.canto-card');
        cards.forEach((card, index) => {
            const match = cantos[index].titulo.toLowerCase().includes(query);
            card.style.display = match ? 'block' : 'none';
        });
    }

    // BUSCADOR EXTERNO: Optimizado para que no falle
    function buscarExterno() {
        const busqueda = document.getElementById('buscador').value;
        if (busqueda.trim() !== "") {
            // Buscamos la canci칩n + letra + cat칩lico para ir a lo seguro
            const url = `https://www.google.com/search?q=${encodeURIComponent(busqueda)} +letra +catolico`;
            window.open(url, '_blank');
        }
    }

    // Detectar el bot칩n "Ir" o "Buscar" del teclado del cel
    document.getElementById('buscador').addEventListener('search', buscarExterno);
    document.getElementById('buscador').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') { buscarExterno(); }
    });

    // GENERADOR DE PDF
    function generarPDF() {
        const areaPdf = document.getElementById('area-pdf');
        areaPdf.innerHTML = '<h1 style="text-align:center; color:#d35400; font-size:40px;">CANCIONERO</h1>';
        areaPdf.style.display = 'block';

        cantos.forEach(canto => {
            areaPdf.innerHTML += `
                <div style="page-break-after: always; padding: 60px 40px; text-align: center;">
                    <h1 style="color: #d35400; font-size: 32px; border-bottom: 2px solid #eee;">${canto.titulo}</h1>
                    <div style="font-size: 22px; line-height: 1.8; white-space: pre-line; margin-top: 30px;">
                        ${canto.letra}
                    </div>
                </div>
            `;
        });

        const config = {
            margin: 0,
            filename: 'Cancionero_Mama.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        };

        html2pdf().set(config).from(areaPdf).save().then(() => {
            areaPdf.style.display = 'none';
        });
    }

    cargarCantos();
</script>

</body>
</html>
