<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Día de Pesca - Relax</title>
    <style>
        body { margin: 0; background: #87CEEB; font-family: 'Arial', sans-serif; overflow: hidden; text-align: center; }
        canvas { background: linear-gradient(#87CEEB 0%, #0077be 30%); display: block; margin: 0 auto; }
        .info { position: absolute; top: 10px; width: 100%; color: white; text-shadow: 2px 2px 4px #000; font-size: 20px; pointer-events: none; }
    </style>
</head>
<body>
    <div class="info">PUNTOS: <span id="score">0</span> | ESPACIO para lanzar el anzuelo</div>
    <canvas id="fishingCanvas"></canvas>

<script>
    const canvas = document.getElementById("fishingCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 800;
    canvas.height = 600;

    let score = 0;
    let hook = { x: 400, y: 100, targetY: 100, state: 'idle', speed: 5 };
    let boatX = 400;
    let fishes = [];

    // Crear peces iniciales
    for(let i=0; i<6; i++) {
        fishes.push(createFish());
    }

    function createFish() {
        return {
            x: Math.random() * canvas.width,
            y: 200 + Math.random() * 350,
            speed: 1 + Math.random() * 2,
            size: 20 + Math.random() * 20,
            color: `hsl(${Math.random() * 360}, 70%, 60%)`,
            direction: Math.random() > 0.5 ? 1 : -1
        };
    }

    function update() {
        // Mover bote con el mouse o automáticamente
        if (hook.state === 'idle') {
            boatX += Math.sin(Date.now() / 1000) * 2; // Bamboleo suave
            hook.x = boatX;
        }

        // Lógica del anzuelo
        if (hook.state === 'dropping') {
            hook.y += hook.speed;
            if (hook.y >= 550) hook.state = 'retracting';
        } else if (hook.state === 'retracting') {
            hook.y -= hook.speed;
            if (hook.y <= 100) {
                hook.y = 100;
                hook.state = 'idle';
            }
        }

        // Mover peces y detectar colisión
        fishes.forEach((fish, index) => {
            fish.x += fish.speed * fish.direction;
            if (fish.x > canvas.width + 50 || fish.x < -50) fish.direction *= -1;

            // Colisión con anzuelo
            if (hook.state === 'dropping' || hook.state === 'retracting') {
                let dx = hook.x - fish.x;
                let dy = hook.y - fish.y;
                let distance = Math.sqrt(dx*dx + dy*dy);

                if (distance < 25) {
                    score += 10;
                    document.getElementById("score").innerText = score;
                    fishes[index] = createFish(); // Respawn del pez
                    hook.state = 'retracting'; // Sube el anzuelo al atrapar uno
                }
            }
        });

        draw();
        requestAnimationFrame(update);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Dibujar Bote
        ctx.fillStyle = "#8B4513";
        ctx.fillRect(boatX - 40, 80, 80, 25);

        // Dibujar Hilo de pesca
        ctx.strokeStyle = "white";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(boatX, 100);
        ctx.lineTo(hook.x, hook.y);
        ctx.stroke();

        // Dibujar Anzuelo
        ctx.strokeStyle = "silver";
        ctx.lineWidth = 4;
        ctx.beginPath();
        ctx.arc(hook.x, hook.y, 8, 0, Math.PI);
        ctx.stroke();

        // Dibujar Peces
        fishes.forEach(fish => {
            ctx.fillStyle = fish.color;
            ctx.beginPath();
            ctx.ellipse(fish.x, fish.y, fish.size, fish.size/2, 0, 0, Math.PI * 2);
            ctx.fill();
            // Cola del pez
            ctx.beginPath();
            ctx.moveTo(fish.x - (fish.size * fish.direction), fish.y);
            ctx.lineTo(fish.x - (fish.size * 1.5 * fish.direction), fish.y - 10);
            ctx.lineTo(fish.x - (fish.size * 1.5 * fish.direction), fish.y + 10);
            ctx.fill();
        });
    }

    window.addEventListener("keydown", (e) => {
        if (e.code === "Space" && hook.state === 'idle') {
            hook.state = 'dropping';
        }
    });

    update();
</script>
</body>
</html>
